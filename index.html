i<!DOCTYPE html>
<html>
<head>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500&display=swap" rel="stylesheet">
    <link rel="icon" href="favicon.png" type="image/png">
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        .video-container {
            position: relative;
            width: 100%;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background: #000;
            overflow: hidden;
        }

        .video-player {
            max-width: 100%;
            max-height: 100vh;
            width: auto;
            height: auto;
            object-fit: contain;
        }

        .controls-overlay {
            position: absolute;
            top: 40px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
            z-index: 10;
            padding: 10px;
            align-items: center;
            opacity: 1;
            transition: opacity 0.5s ease;
        }

        /* Sound toggle button */
        .sound-toggle {
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.5);
            padding: 12px 24px;
            border-radius: 30px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-family: 'Inter', sans-serif;
            font-weight: 500;
            font-size: 16px;
            transition: all 0.3s ease;
            letter-spacing: -0.01em;
        }

        .sound-toggle:hover {
            background: rgba(0, 0, 0, 0.9);
            border-color: white;
            transform: scale(1.05);
        }

        .sound-icon {
            width: 24px;
            height: 24px;
            fill: currentColor;
            flex-shrink: 0;
        }

        /* Volume slider container — expands on hover */
        .volume-wrapper {
            display: flex;
            align-items: center;
            gap: 0px;
        }

        .volume-pill {
            background: rgba(0, 0, 0, 0.7);
            border: 2px solid rgba(255, 255, 255, 0.5);
            border-radius: 30px;
            display: flex;
            align-items: center;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            width: 52px;  /* collapsed: just the icon */
            height: 50px;
            padding: 0 14px;
            cursor: pointer;
            gap: 10px;
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            overflow: visible;
        }

        .volume-pill:hover,
        .volume-pill:focus-within {
            width: 220px;  /* expanded */
            border-color: white;
            background: rgba(0, 0, 0, 0.88);
            box-shadow: 0 0 0 1px rgba(255,255,255,0.12), 0 8px 32px rgba(0,0,0,0.5);
        }

        .volume-icon-wrap {
            display: flex;
            align-items: center;
            flex-shrink: 0;
            color: white;
            transition: transform 0.2s ease;
        }

        .volume-pill:hover .volume-icon-wrap {
            transform: scale(1.1);
        }

        .volume-svg {
            width: 24px;
            height: 24px;
            fill: white;
        }

        /* The track + thumb slider */
        .volume-range {
            -webkit-appearance: none;
            appearance: none;
            flex: 1;
            height: 4px;
            border-radius: 4px;
            outline: none;
            cursor: pointer;
            background: linear-gradient(to right, #fff var(--vol, 100%), rgba(255,255,255,0.25) var(--vol, 100%));
            opacity: 0;
            transform: scaleX(0.7);
            transform-origin: left;
            transition: opacity 0.3s ease 0.05s, transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) 0.05s;
            min-width: 0;
            pointer-events: none;
        }

        .volume-pill:hover .volume-range,
        .volume-pill:focus-within .volume-range {
            opacity: 1;
            transform: scaleX(1);
            pointer-events: auto;
        }

        /* Webkit thumb */
        .volume-range::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #fff;
            cursor: pointer;
            box-shadow: 0 0 0 2px rgba(255,255,255,0.3), 0 2px 8px rgba(0,0,0,0.5);
            transition: transform 0.15s ease, box-shadow 0.15s ease;
        }

        .volume-range::-webkit-slider-thumb:hover {
            transform: scale(1.25);
            box-shadow: 0 0 0 4px rgba(255,255,255,0.2), 0 2px 12px rgba(0,0,0,0.6);
        }

        /* Firefox thumb */
        .volume-range::-moz-range-thumb {
            width: 16px;
            height: 16px;
            border: none;
            border-radius: 50%;
            background: #fff;
            cursor: pointer;
            box-shadow: 0 0 0 2px rgba(255,255,255,0.3), 0 2px 8px rgba(0,0,0,0.5);
            transition: transform 0.15s ease;
        }

        .volume-range::-moz-range-thumb:hover {
            transform: scale(1.25);
        }

        /* Firefox track */
        .volume-range::-moz-range-track {
            height: 4px;
            border-radius: 4px;
            background: rgba(255,255,255,0.25);
        }

        .volume-range::-moz-range-progress {
            height: 4px;
            border-radius: 4px;
            background: #fff;
        }

        /* Percentage label */
        .volume-label {
            font-family: 'Inter', sans-serif;
            font-size: 13px;
            font-weight: 500;
            color: rgba(255,255,255,0.75);
            flex-shrink: 0;
            width: 0;
            overflow: hidden;
            opacity: 0;
            transition: opacity 0.3s ease 0.05s, width 0.4s cubic-bezier(0.34,1.56,0.64,1) 0.05s;
            letter-spacing: -0.02em;
            pointer-events: none;
            white-space: nowrap;
        }

        .volume-pill:hover .volume-label,
        .volume-pill:focus-within .volume-label {
            opacity: 1;
            width: 32px;
        }


        /* ── Drive button ── */
        .drive-button-container {
            width: 100%;
            display: flex;
            justify-content: center;
            padding: 20px 0;
            background: #000;
        }

        .drive-button {
            width: 100px;
            height: 100px;
            background: rgba(255, 255, 255, 0.90);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            cursor: pointer;
            box-shadow:
                0 4px 6px rgba(0,0,0,0.1),
                0 1px 3px rgba(0,0,0,0.08),
                0 8px 12px rgba(255,255,255,0.1),
                inset 0 -2px 5px rgba(0,0,0,0.1);
            transform: translateY(0);
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255,255,255,0.3);
        }

        .drive-button:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow:
                0 7px 14px rgba(0,0,0,0.15),
                0 3px 6px rgba(0,0,0,0.1),
                0 12px 16px rgba(255,255,255,0.1),
                inset 0 -3px 7px rgba(0,0,0,0.1);
            background: rgba(255,255,255,0.95);
        }

        .drive-button:active {
            transform: translateY(1px);
            box-shadow:
                0 2px 4px rgba(0,0,0,0.1),
                0 1px 2px rgba(0,0,0,0.08),
                inset 0 2px 3px rgba(0,0,0,0.1);
        }

        .drive-icon {
            width: 80px;
            height: 80px;
            object-fit: contain;
            filter: drop-shadow(0 2px 3px rgba(0,0,0,0.2));
        }

        /* ── Mobile ── */
        @media (max-width: 768px) {
            .video-container { height: 50vh; }
            .video-player    { max-height: 50vh; }

            .sound-toggle {
                padding: 16px 32px;
                font-size: 18px;
                min-width: 160px;
                min-height: 64px;
                gap: 12px;
            }

            .sound-icon { width: 36px; height: 36px; }

            .volume-pill {
                height: 62px;
                padding: 0 16px;
                width: 62px;
            }

            .volume-pill:hover,
            .volume-pill:focus-within {
                width: 250px;
            }

            .volume-svg { width: 30px; height: 30px; }

            .drive-button {
                width: 150px;
                height: 150px;
                border-radius: 20px;
            }

            .drive-icon { width: 120px; height: 120px; }
            .drive-button-container { padding: 32px 0; }
            .controls-overlay { top: 24px; }
        }

    </style>
</head>
<body>

<div class="video-container">
    <video class="video-player" id="video" autoplay loop playsinline></video>

    <div class="controls-overlay">
        <!-- Mute/unmute toggle -->
        <button class="sound-toggle" onclick="toggleSound()">
            <svg class="sound-icon" viewBox="0 0 24 24">
                <path d="M11 5L6 9H2v6h4l5 4V5zM19.07 4.93l-1.41 1.41C19.1 7.79 20 9.79 20 12c0 2.21-0.9 4.21-2.34 5.66l1.41 1.41C20.88 17.26 22 14.76 22 12c0-2.76-1.12-5.26-2.93-7.07z"/>
                <path d="M15.5 8.5c.84.84 1.5 2.07 1.5 3.5 0 1.43-.66 2.66-1.5 3.5l1.41 1.41C18.13 15.7 19 13.91 19 12c0-1.91-.87-3.7-2.09-4.91L15.5 8.5z"/>
            </svg>
            <span class="sound-text">Mute</span>
        </button>

        <!-- Dynamic volume pill -->
        <div class="volume-wrapper">
            <div class="volume-pill" tabindex="0">
                <div class="volume-icon-wrap">
                    <!-- icon swaps between muted / low / high via JS -->
                    <svg class="volume-svg" id="volIcon" viewBox="0 0 24 24">
                        <path id="volPath" d="M3 9v6h4l5 4V5L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/>
                    </svg>
                </div>
                <input
                    class="volume-range"
                    id="volRange"
                    type="range"
                    min="0" max="100" value="50"
                    aria-label="Volume"
                >
                <span class="volume-label" id="volLabel">50%</span>
            </div>
        </div>
    </div>
</div>

<div class="drive-button-container">
    <a href="https://drive.google.com/drive/folders/1j8Uo6E7vTdCb5wiLLu1614EfVXa61MBv?usp=sharing"
       class="drive-button" target="_blank">
        <img src="https://static.wikia.nocookie.net/mylittlebrony/images/1/1a/Applejack_vector_by_hombre0-d4a3lwt.png/"
             alt="Drive Icon" class="drive-icon">
    </a>
</div>

<script>
    const videoPlayer  = document.querySelector('.video-player');
    const container    = document.querySelector('.video-container');
    const soundText    = document.querySelector('.sound-text');
    const volRange     = document.getElementById('volRange');
    const volLabel     = document.getElementById('volLabel');
    const volPath      = document.getElementById('volPath');

    /* ── HLS setup ── */
    const HLS_SRC = 'https://customer-wxf40czte8oaq6i5.cloudflarestream.com/93cf7378d3c3aa6c112236f8510467b9/manifest/video.m3u8';

    function startPlayback() {
        videoPlayer.volume = 0.5;
        videoPlayer.muted = false;
        videoPlayer.play().catch(() => {
            // Browser blocked unmuted autoplay — start muted instead
            videoPlayer.muted = true;
            soundText.textContent = 'Unmute';
            volRange.value = 0;
            volRange.style.setProperty('--vol', '0%');
            volLabel.textContent = '0%';
            updateVolIcon(0, true);
            videoPlayer.play();
        });
    }

    if (Hls.isSupported()) {
        const hls = new Hls({ startLevel: -1, capLevelToPlayerSize: false });
        hls.loadSource(HLS_SRC);
        hls.attachMedia(videoPlayer);
        hls.on(Hls.Events.MANIFEST_PARSED, function(event, data) {
            hls.currentLevel = hls.levels.length - 1; // force highest quality
            hls.loadLevel = hls.levels.length - 1;    // lock it, no ABR switching
            startPlayback();
        });
    } else if (videoPlayer.canPlayType('application/vnd.apple.mpegurl')) {
        // Safari has native HLS support
        videoPlayer.src = HLS_SRC;
        videoPlayer.addEventListener('loadedmetadata', startPlayback);
    }

    /* ── SVG paths for volume states ── */
    const VOL_PATHS = {
        muted: "M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 4v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z",
        low:   "M18.5 12c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM5 9v6h4l5 4V5L9 9H5z",
        high:  "M3 9v6h4l5 4V5L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"
    };

    function updateVolIcon(val, muted) {
        if (muted || val === 0) {
            volPath.setAttribute('d', VOL_PATHS.muted);
        } else if (val < 50) {
            volPath.setAttribute('d', VOL_PATHS.low);
        } else {
            volPath.setAttribute('d', VOL_PATHS.high);
        }
    }

    /* ── Volume slider ── */
    volRange.addEventListener('input', () => {
        const val = parseInt(volRange.value, 10);
        videoPlayer.volume  = val / 100;
        videoPlayer.muted   = val === 0;
        volLabel.textContent = val + '%';
        volRange.style.setProperty('--vol', val + '%');
        updateVolIcon(val, val === 0);
        // keep the mute button label in sync
        soundText.textContent = videoPlayer.muted ? 'Unmute' : 'Mute';
    });

    /* ── Mute/Unmute toggle button ── */
    function toggleSound() {
        videoPlayer.muted = !videoPlayer.muted;
        soundText.textContent = videoPlayer.muted ? 'Unmute' : 'Mute';

        if (videoPlayer.muted) {
            volRange.value = 0;
            volRange.style.setProperty('--vol', '0%');
            volLabel.textContent = '0%';
        } else {
            // restore to last non-zero value (or default 100)
            const restore = lastVol || 100;
            videoPlayer.volume = restore / 100;
            volRange.value = restore;
            volRange.style.setProperty('--vol', restore + '%');
            volLabel.textContent = restore + '%';
        }
        updateVolIcon(parseInt(volRange.value), videoPlayer.muted);

        if (!videoPlayer.muted && videoPlayer.paused) {
            videoPlayer.play().catch(e => {
                videoPlayer.muted = true;
                soundText.textContent = 'Unmute';
                videoPlayer.play();
            });
        }
    }

    // track last non-zero volume so unmuting restores it
    let lastVol = 50;

    // Initialize UI immediately so it shows 50% from the start
    volRange.value = 50;
    volRange.style.setProperty('--vol', '50%');
    volLabel.textContent = '50%';
    updateVolIcon(50, false);

    volRange.addEventListener('change', () => {
        const val = parseInt(volRange.value, 10);
        if (val > 0) lastVol = val;
    });

    /* ── Video sizing ── */
    function adjustVideoSize() {
        const cw = container.clientWidth, ch = container.clientHeight;
        const ar = videoPlayer.videoWidth / videoPlayer.videoHeight;
        if (cw / ch > ar) {
            videoPlayer.style.height = '100%';
            videoPlayer.style.width  = 'auto';
        } else {
            videoPlayer.style.width  = '100%';
            videoPlayer.style.height = 'auto';
        }
    }

    videoPlayer.addEventListener('loadedmetadata', adjustVideoSize);

    let resizeTimeout;
    window.addEventListener('resize', () => {
        clearTimeout(resizeTimeout);
        resizeTimeout = setTimeout(adjustVideoSize, 250);
    });

    window.addEventListener('orientationchange', () => setTimeout(adjustVideoSize, 100));

    /* ── Auto-hide controls ── */
    let hideTimeout;
    const controlsEl = document.querySelector('.controls-overlay');
    const volPill     = document.querySelector('.volume-pill');

    function showControls() {
        controlsEl.style.opacity = '1';
        clearTimeout(hideTimeout);
        hideTimeout = setTimeout(() => {
            // Don't hide if the volume pill is being hovered
            if (!volPill.matches(':hover') && !volPill.matches(':focus-within')) {
                controlsEl.style.opacity = '0';
            }
        }, 4000);
    }

    // Keep visible while interacting with volume
    volPill.addEventListener('mouseenter', () => {
        clearTimeout(hideTimeout);
        controlsEl.style.opacity = '1';
    });
    volPill.addEventListener('mouseleave', showControls);

    container.addEventListener('mousemove',  showControls);
    container.addEventListener('touchstart', showControls);
    showControls();
</script>
</body>
</html>
